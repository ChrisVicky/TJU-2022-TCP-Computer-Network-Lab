

          ┌───────────────┐                                           ┌─────────────┐
          │  MAIN THREAD  ├───────────► START SIMULATION ───────────► │ RECV THREAD │
          └───────────────┘                                           └─────┬───────┘
                 │                     ┌────────────────┐                   │
                 │─────── tju_socket ─►│ SENDING THREAD │                   │
                 │                     └───────┬────────┘                   │
                 │                             │                            │
                 │                   ┌─────────┴───────────┐                │
                 │                   │                     │                │
                 │─────── tju_send ─►│ sock->sending_queue │                │
                 │                   │                     │                │
                 │                   └─────────┬───────────┘                │
                 │                             │                            │
                 │                             ▼                            │
                 │                  send with retransmistion                │
                 │                       │            │                     │
                 │                       │            │                     │
                 │                       ▼            ▼                     │
                 │                 ┌──────────┐                             │
                 │                 │timer list│    toLayer3                 │
                 │                 └──────────┘                             │
                 │                     ▲ │            │                     │
                 │                     │ │            │                     ▼             ┌─────────────────────┐
                 │                     │ │retransmit  │send          ┌─────────────┐─────►│                     │
                 │                     │ └────────────┴─────────────►│handle packet│      │ sock->disorder_tree │
                 │                     │ACK                          └─────────────┘◄─────│                     │
                 │                     └────────────────────────────────────┤             └─────────────────────┘
                 │                                                          │
                 │                                                          ▼
                 │                                                 ┌───────────────────┐
                 │                                                 │                   │
                 │◄─────── tju_recv ───────────────────────────────│ sock->recv_buffer │
                 │                                                 │                   │
                 │                                                 └───────────────────┘
                 │
                 ▼







